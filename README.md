## Задание 1: Разведка системы
### Шаги выполнения:
Мы выполнили сканирование защищаемой системы (192.168.1.112) с помощью nmap, используя следующие команды:
```
sudo nmap -sA 192.168.1.112  # TCP ACK scan
sudo nmap -sT 192.168.1.112  # TCP Connect scan
sudo nmap -sS 192.168.1.112  # SYN scan
sudo nmap -sV 192.168.1.112  # Service version detection
```

### Результаты сканирования:

1. Открытый порт 22 (SSH):
- Сервис: SSH.
- Версия: OpenSSH 9.6p1 (Ubuntu Linux; протокол 2.0).
- Операционная система: Linux (Ubuntu).
2. MAC-адрес:
- 08:00:27:00:6B:67 (принадлежит Oracle VirtualBox, что подтверждает, что это виртуальная машина).
3. Другие порты:
- Все остальные TCP-порты закрыты (999 портов).
#### Логи Suricata:
В логах Suricata (/var/log/suricata/fast.log) были зафиксированы следующие события:
- Событие "SURICATA TCPv4 invalid checksum":
```
[**] [1:2200074:2] SURICATA TCPv4 invalid checksum [**]
```

Это событие связано с пакетом, отправленным во время сканирования, который содержал некорректную контрольную сумму TCP. Это могло быть вызвано сканированием nmap.
- События "Ethertype unknown" и "Spotify P2P Client":
Эти события не связаны с нашей активностью и могут быть игнорированы.

#### Логи Fail2Ban:
В логах Fail2Ban (/var/log/fail2ban.log) не было записей, связанных со сканированием. Это означает, что сканирование не вызвало достаточного количества подозрительных действий для блокировки.


#### Комментарии к результатам:
- Suricata: Зафиксировала сканирование, но не заблокировала его напрямую. Правила Suricata не обнаружили явной угрозы.
- Fail2Ban: Не отреагировал, так как сканирование не включало попыток входа через SSH.


## Задание 2: Атака на подбор пароля для службы SSH
### Шаги выполнения:
Мы выполнили атаку подбора пароля для SSH с помощью hydra. Команда выглядела так:
```
hydra -L users.txt -P pass.txt ssh://192.168.1.112
```
Файлы users.txt и pass.txt содержали случайные строки, а также имя и пароль существующего пользователя.

#### Результаты атаки:
##### 1. Первая атака:
- Hydra выполнила атаку, но не смогла подобрать пароль.
- В логах Fail2Ban появилось 3 неудачные попытки входа, но IP-адрес злоумышленника не был заблокирован.
##### 2. Вторая атака (после добавления больше паролей):
- Hydra выполнила атаку с увеличенным количеством паролей.
- После 10 неудачных попыток входа Fail2Ban заблокировал IP-адрес злоумышленника (192.168.1.98).

#### Логи Suricata:
В логах Suricata не было явных записей о блокировке атаки hydra. Однако система зарегистрировала другие события, такие как "Ethertype unknown".

Логи Fail2Ban:
В логах Fail2Ban (/var/log/fail2ban.log) были зафиксированы следующие события:

- Запись о блокировке IP-адреса злоумышленника
```
[sshd] Ban 192.168.1.98
```
- Текущий статус Jail для SSH:
```
sudo fail2ban-client status sshd
```
- Currently banned: 1
- Total banned: 1
- Banned IP list: 192.168.1.98


##### Проверка блокировки:
Попытка подключения к SSH с машины злоумышленника завершилась ошибкой:
```
ssh: connect to host 192.168.1.112 port 22: Connection refused
```
### Комментарии к результатам:
- Hydra: Успешно выполнила атаку подбора пароля, но пароль не был найден.
- Fail2Ban: Сработал корректно и заблокировал IP-адрес злоумышленника после 10 неудачных попыток входа.
- Suricata: Не заблокировала атаку напрямую, но зафиксировала подозрительный трафик.
### Итоговый вывод:
1. Suricata:
- Зафиксировала сканирование и атаку, но не заблокировала их напрямую.
- Правила Suricata можно улучшить для обнаружения подобных атак.
2. Fail2Ban:
- Сработал корректно и заблокировал IP-адрес злоумышленника после превышения порога maxRetry.
3. Общая защита:
- Защита SSH работает эффективно благодаря комбинации Fail2Ban и правил файрвола.